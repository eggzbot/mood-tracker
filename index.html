<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mood Tracker</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
      background: #0d1117;
      color: #c9d1d9;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 40px 20px;
    }
    h1 { margin-bottom: 8px; font-size: 24px; }
    p { color: #8b949e; margin-bottom: 24px; font-size: 14px; }
    .legend {
      display: flex;
      gap: 16px;
      margin-bottom: 20px;
      font-size: 12px;
    }
    .legend-item { display: flex; align-items: center; gap: 6px; }
    .cell { width: 12px; height: 12px; border-radius: 2px; }
    .cell-empty { background: #161b22; border: 1px solid #30363d; }
    .cell-happy { background: #39d353; }
    .cell-sad { background: #58a6ff; }
    .grid {
      display: grid;
      grid-template-columns: repeat(53, 1fr);
      gap: 3px;
    }
    @media (max-width: 800px) {
      .grid { grid-template-columns: repeat(26, 1fr); }
    }
    .weekday {
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      height: 120px;
      margin-right: 4px;
      font-size: 10px;
      color: #8b949e;
    }
    .container {
      display: flex;
      overflow-x: auto;
      max-width: 100%;
    }
    .month-labels {
      display: flex;
      gap: 52px;
      margin-bottom: 8px;
      margin-left: 16px;
      font-size: 10px;
      color: #8b949e;
    }
    @media (max-width: 800px) {
      .month-labels { gap: 24px; }
    }
  </style>
</head>
<body>
  <h1>Mood Tracker</h1>
  <p>green = happy &nbsp;|&nbsp; blue = sad &nbsp;|&nbsp; empty = no data</p>
  
  <div class="legend">
    <div class="legend-item"><div class="cell cell-empty"></div> no data</div>
    <div class="legend-item"><div class="cell cell-sad"></div> sad</div>
    <div class="legend-item"><div class="cell cell-happy"></div> happy</div>
  </div>
  
  <div class="month-labels" id="months"></div>
  
  <div class="container">
    <div class="weekday">
      <span></span>
      <span>Mon</span>
      <span></span>
      <span>Wed</span>
      <span></span>
      <span>Fri</span>
      <span></span>
    </div>
    <div class="grid" id="grid"></div>
  </div>

  <script>
    let moodData = {};
    
    fetch('data.json')
      .then(r => r.json())
      .then(data => {
        moodData = data;
        generateGrid();
      })
      .catch(() => generateGrid());
    
    function getDayOfYear(date) {
      const start = new Date(date.getFullYear(), 0, 0);
      const diff = date - start;
      return Math.floor(diff / (1000 * 60 * 60 * 24));
    }
    
    function generateGrid() {
      const grid = document.getElementById('grid');
      const months = document.getElementById('months');
      const today = new Date();
      const startDate = new Date(today);
      startDate.setDate(startDate.getDate() - 364);
      
      let monthLabels = [];
      let currentMonth = -1;
      
      for (let i = 0; i < 371; i++) {
        const date = new Date(startDate);
        date.setDate(date.getDate() + i);
        
        const month = date.getMonth();
        if (month !== currentMonth) {
          currentMonth = month;
          monthLabels.push(date.toLocaleString('default', { month: 'short' }));
        }
        
        const dateStr = date.toISOString().split('T')[0];
        const cell = document.createElement('div');
        cell.className = 'cell cell-empty';
        
        if (moodData[dateStr] === 'happy') {
          cell.className = 'cell cell-happy';
        } else if (moodData[dateStr] === 'sad') {
          cell.className = 'cell cell-sad';
        }
        
        cell.title = dateStr + (moodData[dateStr] ? ': ' + moodData[dateStr] : '');
        grid.appendChild(cell);
      }
      
      months.innerHTML = monthLabels.map(m => `<span>${m}</span>`).join('');
    }
  </script>
</body>
</html>
